name: APPDOME_CI_EXAMPLE
# Controls when the workflow will run
on:
 # Triggers the workflow on push or pull request events but only for the "main" branch
 push:
  branches: [ "github" ]
 pull_request:
  branches: [ "github" ]
 # Allows you to run this workflow manually from the Actions tab
 workflow_dispatch:
# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
 # This workflow contains a single job called "build"
 a:
 # The type of runner that the job will run on
  runs-on: ubuntu-latest
 # Steps represent a sequence of tasks that will be executed as part of the job
  steps:
 # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
   - uses: actions/checkout@v3
   - name: Appdome build-2secure
  # You may pin to the exact commit or the version.
     uses: Appdome/github_build-2secure@1.3.1
     with:
       APPDOME_API_TOKEN: ${{secrets.APPDOME_API_KEY}}
       SIGN_OPTIONS: "PRIVATE_SIGNING"

       # iOS
       # APP_FILE: "./ARandomNumber.ipa"
       # MOBILE_PROVISION_PROFILE_FILE: "./Automation.mobileprovision"
       # ENTITLEMENTS_FILE: "./AutomationEntitlements.plist"
       # KEYSTORE_FILE: "./AutomationCert.p12"
       # CERTIFICATE_PASSWORD: "nf1101"
       # FUSION_SET_ID:  "dd6b1360-5864-11ee-96fa-bb616f57e574"

       # Android
       APP_FILE: "https://appdome-automation-vanilla-apps.s3.eu-central-1.amazonaws.com/Thomas/FileFinder.aab?response-content-disposition=inline&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEFEaDGV1LWNlbnRyYWwtMSJIMEYCIQCtYHb5zeBLtBval8plm0UKkOe4irdAlemAc6DyATc6bwIhAJHHCD3V3jWmFGphHFy1ovxKBiw0W7mUA0BMd76sAAq0KoUDCFoQABoMMzAyMjY3NjU0Mzk0IgyQVegF2jBjbnC2TJsq4gJSag6SQ6fqlZRhgi2z%2BMl0%2Fvtc27UEoEXL1UpxXZ4bx0EXYJSbhEd09%2BnDa1mZFZZTlJzTldaOz3qulcFIz94F8UWmfpIBssTqVsiI30A43ItkzkwxxegcBPA6QCMbKa%2BgmwszO%2B0g68C3jIcTpCQuUq6gxOeCwUiBVUwKFNX4b6MUVPG6p1Z3RqvmM1PlpQUf1ZcrwHR9U8%2BwA4p9cW6NC8cCLo%2FXXpmUbqAKOYcDsLqnwBt96v0GfVXIte4zmImWj%2Bp%2BGjJPiJLMe8PyUbzLPZ7OiiHSyB2jll7REvZFKyFLRMDYvFpfi528zE8gj8eUZSXJKd43yAYDxFHV8B08SC%2BG8qhCYui2YO8LFvEZx1xUmyWwb4C4LB1wMaiXz6m4jmOnwKJUUO3oK0IuilppAonJRGLxnlAFfZsRk%2Bm0IQOzs17MWCVYXE0ZkIi1KXtFXQBCf5tlVokmjAq9fPmcx6Ew1Of5qAY6sgJ%2B%2FFh4WafzVBJYHC%2Bl4mxAe5FJUgHzWWPl8tKmb8OOxFkSoGcC%2BRdYGttUz7TJx%2BJIWMWodaMSk5InVfj1PxwIot4KSwhLtTWAlyZYYTy6Yg6RWOaoSh6%2BJroUhfRaXExH4NV5nO23nAz%2BgnLAQEY6%2B9crQW3ZEzB8RMMUvedd%2FQmzzi%2FydVSEScxf%2Ba%2F%2BgS2phQnwWAwvJh6Ara33qPte9eo%2FDWhQRkj9x4e5LJimWkzAL942NNs8eYWrsLgg%2Fmv5%2Bd4Dud1LxI4vGbGZZM9T0%2B0TUMP9w8sPEZF8Hdgab3ewc5YN3aTb43M1xn6%2B1g8GbMEyYIREANqD6xMo5AsPM5O40QBsghmALSD2I0JtashlM7uis99hBLOO3QaNvzKdWOYzlBp5z3mLQ8Pj7Kg5ANA%3D&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20231005T090335Z&X-Amz-SignedHeaders=host&X-Amz-Expires=7200&X-Amz-Credential=ASIAUMYEOMD5AGJEZZ5S%2F20231005%2Feu-central-1%2Fs3%2Faws4_request&X-Amz-Signature=e5544cb3bdb409ed619ea5117d25f6afe19fd98ba1b83f5cb6b26c180db7ada9"
       # KEYSTORE_FILE: "./appdome.keystore"
       # KEYSTORE_PASSWORD: "appdome"
       # KEYSTORE_ALIAS: "appdome"
       # KEYSTORE_KEY_PASSWORD: "appdome"
       FUSION_SET_ID:  "d2574330-5856-11ee-800b-a111bd4d22d3"
       SIGN_FINGERPRINT: "8DF593C1B6EAA6EADADCE36831FE82B08CAC8D74"

       # SECOND_OUTPUT: true
       # OUTPUT_APP_NAME: "test/test_app.apk"
#        BUILD_TO_TEST: "saucelabs"
       
   - name: Example of using Appdome secured app
     run: |
        echo ${{ env.APPDOME_SECURED_APP }}
        echo ${{ env.APPDOME_SECURED_APP_SECOND_OUTPUT }}

