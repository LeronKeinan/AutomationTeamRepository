name: APPDOME_CI_EXAMPLE
# Controls when the workflow will run
on:
 # Triggers the workflow on push or pull request events but only for the "main" branch
 push:
  branches: [ "github" ]
 pull_request:
  branches: [ "github" ]
 # Allows you to run this workflow manually from the Actions tab
 workflow_dispatch:
# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
 # This workflow contains a single job called "build"
 a:
 # The type of runner that the job will run on
  runs-on: ubuntu-latest
 # Steps represent a sequence of tasks that will be executed as part of the job
  steps:
 # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
   - uses: actions/checkout@v3
   - name: Appdome build-2secure
  # You may pin to the exact commit or the version.
     uses: Appdome/github_build-2secure@latest
     with:
       APPDOME_API_TOKEN: ${{secrets.APPDOME_API_KEY}}
       SIGN_OPTIONS: "SIGN_ON_APPDOME"

       # iOS
       APP_FILE: "./filefinder.ipa"
       CERTIFICATE_FILE: "https://appdome-automation-vanilla-apps.s3.eu-central-1.amazonaws.com/Thomas/AutomationCert.p12?response-content-disposition=inline&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJD%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaDGV1LWNlbnRyYWwtMSJIMEYCIQD%2BA0JfH2H3jOk7TwP7ZQzMMiTzrYFiWGl7s0ZQBT49mwIhAPRsCdk1SUdfs%2BedQJAqJd8aZ%2FfLTDdcU46RYGdl14EaKo4DCLn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQABoMMzAyMjY3NjU0Mzk0Igwgtnkzl%2BENwAiJEcQq4gJFaOuUYNdr54VPJ0h6xD1iVsA0wlhvTFW%2Fyhc96%2FaRr%2FAay%2Be3KfUd%2BqloVB7qdvyf1pnsVApeUdeTJajILhQ%2FtOiWoVjVKGudZ7%2BgblCGcmQDa%2FKgJCVholdpTocXbU0rJwBiWnBaxN0HmjaHbvmH98C5oMPb%2BoB6fQuDI7%2F57ccofMGfdkCQCWXMwNmWj04hDxKHJX6CR0oxPTdQDsjERp%2Ft0%2FBBbfNlG%2B5klJmcPif3PbSHu7aBYUvN3jxlcQ9A5Uty4lpjbLn9PohReRc8j%2B5gxNLqcS2OT946ouPp7QWxzW7uMpiVZvNC91xMHm8WEg2yiKJENUm4bw8%2BMMfMXrcxVjqQUxkakfKfUir8KTphXZIt2foUo1ysg2OJAOSFffyIlcTLHR6rf9hdyHIduOUhv1lE8XTIVKKyigiQPkq%2BgJct%2FthZINs%2FpbDAoPMTKf7Us2UVS%2FBadsXE5WXjfu4wiZX4qQY6sgJ63v0BlQfYzUBHJqqVXgJnf7J%2FI2fehJYl7g0h%2BH%2BKSaaoLkSdQdvoboz1H92s%2FmcuBJO25eBWjPvN4qvkdOQldwBAKF7lJU17E%2B26IgqKyCADvXWq2jLO53H7KrbwZqswwoN19MrQ0rZ5RGSK6I6tki1XBK%2Bzhv5kQUcYJIE17Nk2TdJlH7nwC3hvqTQ0iUFVjpMIF8jvg9d48IrviQYFrWpKd7ffQXGiaZZRhUu0fzf%2FHMJDop7SDSu0799QcU%2BPMhTGMjvPjepcRyuRmnJb1aqC3UaRbMC3WMOGez2v2%2Bw2cvBA204r3rwlwMSF8o6rRHmt0TTbcXis6ZevcldVRHuDtHz2AUQ5IgTm%2BJzbZaAQLq1VifZlnvlraemtamKXJr1OXViaPfH1lNRWoTW1ea8%3D&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20231029T082514Z&X-Amz-SignedHeaders=host&X-Amz-Expires=32400&X-Amz-Credential=ASIAUMYEOMD5NDLYAWHP%2F20231029%2Feu-central-1%2Fs3%2Faws4_request&X-Amz-Signature=d534150d50faeb508d1616e43a34afb057f0df378286d2001709ad5b0570ef26"
       CERTIFICATE_PASSWORD: "nf1101"
       MOBILE_PROVISION_PROFILE_FILE: "./Automation.mobileprovision"
       ENTITLEMENTS_FILE: "AutomationEntitlements.plist"
       FUSION_SET_ID:  "dd6b1360-5864-11ee-96fa-bb616f57e574"

       # Android
       # APP_FILE: "./FileFinder.aab"
       # KEYSTORE_FILE: "https://appdome-automation-vanilla-apps.s3.eu-central-1.amazonaws.com/Thomas/appdome.keystore?response-content-disposition=inline&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJD%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaDGV1LWNlbnRyYWwtMSJIMEYCIQD%2BA0JfH2H3jOk7TwP7ZQzMMiTzrYFiWGl7s0ZQBT49mwIhAPRsCdk1SUdfs%2BedQJAqJd8aZ%2FfLTDdcU46RYGdl14EaKo4DCLn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQABoMMzAyMjY3NjU0Mzk0Igwgtnkzl%2BENwAiJEcQq4gJFaOuUYNdr54VPJ0h6xD1iVsA0wlhvTFW%2Fyhc96%2FaRr%2FAay%2Be3KfUd%2BqloVB7qdvyf1pnsVApeUdeTJajILhQ%2FtOiWoVjVKGudZ7%2BgblCGcmQDa%2FKgJCVholdpTocXbU0rJwBiWnBaxN0HmjaHbvmH98C5oMPb%2BoB6fQuDI7%2F57ccofMGfdkCQCWXMwNmWj04hDxKHJX6CR0oxPTdQDsjERp%2Ft0%2FBBbfNlG%2B5klJmcPif3PbSHu7aBYUvN3jxlcQ9A5Uty4lpjbLn9PohReRc8j%2B5gxNLqcS2OT946ouPp7QWxzW7uMpiVZvNC91xMHm8WEg2yiKJENUm4bw8%2BMMfMXrcxVjqQUxkakfKfUir8KTphXZIt2foUo1ysg2OJAOSFffyIlcTLHR6rf9hdyHIduOUhv1lE8XTIVKKyigiQPkq%2BgJct%2FthZINs%2FpbDAoPMTKf7Us2UVS%2FBadsXE5WXjfu4wiZX4qQY6sgJ63v0BlQfYzUBHJqqVXgJnf7J%2FI2fehJYl7g0h%2BH%2BKSaaoLkSdQdvoboz1H92s%2FmcuBJO25eBWjPvN4qvkdOQldwBAKF7lJU17E%2B26IgqKyCADvXWq2jLO53H7KrbwZqswwoN19MrQ0rZ5RGSK6I6tki1XBK%2Bzhv5kQUcYJIE17Nk2TdJlH7nwC3hvqTQ0iUFVjpMIF8jvg9d48IrviQYFrWpKd7ffQXGiaZZRhUu0fzf%2FHMJDop7SDSu0799QcU%2BPMhTGMjvPjepcRyuRmnJb1aqC3UaRbMC3WMOGez2v2%2Bw2cvBA204r3rwlwMSF8o6rRHmt0TTbcXis6ZevcldVRHuDtHz2AUQ5IgTm%2BJzbZaAQLq1VifZlnvlraemtamKXJr1OXViaPfH1lNRWoTW1ea8%3D&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20231029T073408Z&X-Amz-SignedHeaders=host&X-Amz-Expires=32400&X-Amz-Credential=ASIAUMYEOMD5NDLYAWHP%2F20231029%2Feu-central-1%2Fs3%2Faws4_request&X-Amz-Signature=b511c8429dceef015c0064744a93354c2647fb97304d45087c3cddea0eb1df87"
       # KEYSTORE_PASSWORD: "appdome"
       # KEYSTORE_ALIAS: "appdome"
       # KEYSTORE_KEY_PASSWORD: "appdome"
       # FUSION_SET_ID:  "d2574330-5856-11ee-800b-a111bd4d22d3"
       # SIGN_FINGERPRINT: "8DF593C1B6EAA6EADADCE36831FE82B08CAC8D74"
       # GOOGLE-PLAY-SIGNING: true

       SECOND_OUTPUT: true
       BUILD_WITH_LOGS: true
       OUTPUT_APP_NAME: "test_dir/test_app.ipa"
       BUILD_TO_TEST: "saucelabs"
       
   - name: Example of using Appdome secured app
     run: |
        echo ${{ env.APPDOME_SECURED_APP }}
        echo ${{ env.APPDOME_SECURED_APP_SECOND_OUTPUT }}
        echo $APPDOME_SECURED_APP
        echo $APPDOME_SECURED_APP_SECOND_OUTPUT
